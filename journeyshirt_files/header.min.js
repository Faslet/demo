!async function(){if(!0===window.tpHeaderLoaded)return;window.tpHeaderLoaded=!0;const t="//ecommplugins-trustboxpreview.trustpilot.com/v1.0/trustboxpreview.min.js",e="//ecommplugins-scripts.trustpilot.com/v2.1/css/preview.min.css",o="TRUSTPILOT_SKU_VALUE_";function r(t){return btoa(encodeURIComponent(t).replace(/%([0-9A-F]{2})/g,function(t,e){return String.fromCharCode(parseInt(e,16))}))}const n=new URL(document.currentScript.src),i=n.searchParams?n.searchParams.get("settings"):void 0,s=i?JSON.parse((p=i,decodeURIComponent(Array.prototype.map.call(atob(p),function(t){return"%"+("00"+t.charCodeAt(0).toString(16)).slice(-2)}).join("")))):{};var p;"undefined"==typeof TrustpilotObject&&function(t,e,o,r,n){t.TrustpilotObject=n,t.tp=t.tp||function(){(t.tp.q=t.tp.q||[]).push(arguments)},a=e.createElement(o),a.async=1,a.src="https://invitejs.trustpilot.com/tp.min.js",a.type="text/java"+o,f=e.getElementsByTagName(o)[0],f.parentNode.insertBefore(a,f)}(window,document,"script",0,"tp"),tp("register",s.key);const d=new CustomEvent("trustpilotScriptLoaded");if(dispatchEvent(d),function(t){return t&&t.searchParams&&"true"===t.searchParams.get("tpTrustBoxPreview")?(window.sessionStorage.setItem("tpTrustBoxPreview",!0),!0):window.localStorage.getItem("tpTrustBoxPreview")?(window.localStorage.removeItem("tpTrustBoxPreview"),window.sessionStorage.setItem("tpTrustBoxPreview",!0),!0):!!window.sessionStorage.getItem("tpTrustBoxPreview")}(new URL(window.location.href))){document.body.style.paddingTop="75px";var u=document.createElement("script");if(u.type="text/javascript",u.src="//widget.trustpilot.com/bootstrap/v5/tp.widget.bootstrap.min.js",u.async=!0,document.head.appendChild(u),"undefined"==typeof TrustpilotPreview)try{var c=document.createElement("script");c.type="text/javascript",c.src="//ecommplugins-scripts.trustpilot.com/v2.1/js/preview_shopify.js",c.onload=function(t){const e=document.createElement("iframe");e.id="pixel_iframe",e.src="//ecommscript-integrationapp.trustpilot.com/pixel/index.html",e.setAttribute("style","display: none; width: 1px; height: 1px;"),e.onload=function(t){document.getElementById("pixel_iframe").contentWindow.postMessage(JSON.stringify({basis:"iframe",action:"initialLoad"}),"https://ecommscript-integrationapp.trustpilot.com")},document.body.appendChild(e)},document.head.appendChild(c)}catch(d){console.log("TrustpilotPreview couldn't load")}window.addEventListener("message",function(o){var a=new URL(window.location).hostname;!o.data||-1===o.origin.indexOf(a)&&"https://ecommscript-integrationapp.trustpilot.com"!==o.origin||"undefined"!=typeof TrustpilotPreview&&("string"==typeof o.data&&"submit"===o.data?TrustpilotPreview.sendTrustboxes():"string"==typeof o.data&&(jsonData=JSON.parse(o.data),jsonData.trustbox?TrustpilotPreview.setSettings(jsonData.trustbox):"updatePageUrls"===jsonData.type||"newTrustBox"===jsonData.type||"deletePageTrustBoxes"===jsonData.type?TrustpilotPreview.sendDataTransfer(o.data):"loadCategoryProductInfo"===jsonData.type?function(){const t=$("a.product").toArray().map(t=>t.href.split("/").pop());return Promise.all(t.map(t=>new Promise((e,o)=>{Shopify.getProduct(t,e)}))).then(t=>{const e=g(),o=t.map(t=>({productUrl:t.url,id:t.id.toString(),variationIds:t.variants.map(t=>t.id.toString()),variationSkus:t.variants.map(t=>t[e]),name:t.title}));return o})}().then(t=>{window.postMessage(JSON.stringify(t),window.origin)}):jsonData.customised?TrustpilotPreview.updateActive(jsonData.customised):jsonData.loadData&&function(o){var a=document.createElement("div");a.id="trustpilot_initial_data",a.setAttribute("data-page-urls",r(JSON.stringify(o.loadData.trustbox.pageUrls))),a.setAttribute("data-custom-trustboxes",o.loadData.customTrustBoxes),a.setAttribute("data-settings",r(JSON.stringify(o.loadData))),a.setAttribute("id","trustpilot-trustbox-preview"),a.setAttribute("data-source","Shopify"),a.setAttribute("data-sku",m()),document.body.appendChild(a);var n=document.createElement("script");n.type="text/javascript",n.src=t,n.async=!0,n.onload=function(){const t=JSON.stringify({basis:"iframe",TrustBoxPreviewMode:{integrationKey:s.key},enable:!0,widgets:o.widgets});window.postMessage(t,window.origin)},document.head.appendChild(n),TrustpilotPreview.init([e],o.loadData.trustbox,window,document.getElementById("pixel_iframe").contentWindow)}(jsonData)))})}else"undefined"!=typeof trustpilot_trustbox_settings?await w():addEventListener("trustpilotTrustboxSettingsLoaded",async function(){await w()});function l(t){var e=m(t).join(","),o=function(){var t=ShopifyAnalytics&&ShopifyAnalytics.meta||t;if(t&&t.product&&t.product.variants&&t.product.variants.length>0){var e=t.product.variants;if(t.product.selectedVariantId)for(var o=0;o<e.length;o++)if(e[o].id==t.product.selectedVariantId)return e[o].name;return e[0].name}}();for(var a in trustpilot_trustbox_settings.trustboxes)trustpilot_trustbox_settings.trustboxes[a].sku=e,trustpilot_trustbox_settings.trustboxes[a].name=o}function m(t){t=g(t);var e=[];if(meta&&meta.product&&meta.product.variants){e.push(`${o}${meta.product.id}`);var a=meta.product.variants;for(var r in a)a[r][t]&&(e.push(a[r][t]),e.push(`${o}${a[r].id}`))}return e}function g(t){return t||(t="sku"),t}async function w(){const t=function(){const t=document.head.querySelector("[property~='og:type'][content]"),e=t?t.content:"",o=location.pathname;return meta&&meta.page&&"home"===meta.page.pageType||"/"===location.pathname?"landing":meta&&meta.page&&"collection"===meta.page.pageType||"product.group"===e||/^\/collections(\/[a-z0-9-_]+\/?$)?\/?$/.test(o)?"category":meta&&meta.page&&"product"===meta.page.pageType||meta&&void 0!==meta.product||"product"===e||/^\/(collections\/[a-z0-9-_]+\/)?products\/[a-z0-9-_]+\/?$/.test(o)?"product":void 0}();"product"===t&&l(),trustpilot_trustbox_settings.trustboxes=trustpilot_trustbox_settings.trustboxes.filter(function(e){return t===e.page||v(e.page)===v(location.origin+location.pathname)||e.page.toLowerCase()===btoa(location.origin+location.pathname).toLowerCase()}),tp("trustBox",trustpilot_trustbox_settings)}function v(t){return"string"==typeof t?t.replace(/\/+$/,""):t}}();
//# sourceMappingURL=header.min.js.map
